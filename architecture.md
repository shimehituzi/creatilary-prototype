# ドット絵アセット管理アプリ プロトタイプ設計書

## 概要

16x16ドット絵のゲームアセットを作成・管理するためのアプリケーション。主にゲーム開発で使用するスプライトやアニメーションの管理に特化し、シンプルな編集機能と強力な管理機能を提供する。

## 目的

- ゲーム開発用の16x16ドット絵アセットを効率的に管理する
- アニメーションフレームの管理を容易にする
- カテゴリによる構造化された管理を実現する
- 必要に応じてJSONフォーマットでのエクスポート/インポートを可能にする

## データ構造

```typescript
// スプライトフレーム（1つのドット絵）
type SpriteFrame = {
  id: string;           // フレームの一意のID
  grid: number[][];     // 16x16のグリッド（色のインデックス）
  duration?: number;    // アニメーション時の表示時間（ミリ秒）
};

// カラーパレット
type ColorPalette = {
  id: string;           // パレットのID
  colors: string[];     // sRGBA形式の色配列
};

// カテゴリ階層
type Category = {
  id: string;           // カテゴリの一意のID
  name: string;         // カテゴリ名
  parentId: string | null; // 親カテゴリのID（トップレベルならnull）
};

// スプライト
type Sprite = {
  id: string;           // スプライトの一意のID
  name: string;         // スプライト名
  categoryId: string;   // 所属するカテゴリのID
  frames: SpriteFrame[]; // アニメーションフレーム
  createdAt: number;    // 作成日時
  updatedAt: number;    // 更新日時
};

// 永続化が必要なアプリケーションデータ
type AppData = {
  sprites: Sprite[];
  categories: Category[];
  palettes: ColorPalette[];
};
```

## 標準カテゴリ

プリセットとして以下のカテゴリを提供：

1. **キャラクター**
   - プレイヤーキャラクター
   - 敵キャラクター
   - NPCキャラクター

2. **アイテム**
   - 武器
   - 防具
   - 消費アイテム
   - 収集アイテム

3. **環境**
   - 地形タイル
   - 背景オブジェクト
   - インタラクティブオブジェクト
   - 装飾品

4. **エフェクト**
   - 攻撃エフェクト
   - 魔法エフェクト
   - 環境エフェクト
   - パーティクル

5. **UI要素**
   - アイコン
   - ボタン
   - ウィンドウ要素
   - カーソル

## 機能要件

### コア機能

1. **アセット管理**
   - アセットの作成、編集、削除
   - カテゴリによる整理
   - 名前による検索

2. **フレーム管理**
   - フレームの追加、削除、並べ替え
   - フレームのコピー、ペースト
   - フレーム表示時間の設定

3. **カテゴリ管理**
   - カテゴリの作成、編集、削除
   - 階層構造の管理

4. **検索とフィルタリング**
   - カテゴリによる検索
   - 名前による検索
   - 複合条件によるフィルタリング

### 編集機能

1. **基本編集**
   - ピクセル単位での色の適用
   - 消しゴム機能
   - 色の選択

2. **パレット管理**
   - カラーパレットの作成、編集
   - パレット間の切り替え

### プレビュー機能

1. **静止画プレビュー**
   - 拡大表示
   - グリッド表示/非表示

2. **アニメーションプレビュー**
   - 再生/停止
   - 速度調整
   - ループ設定

### インポート/エクスポート

1. **JSONフォーマット**
   - 個別アセットのエクスポート/インポート
   - 複数アセットのバッチエクスポート/インポート

2. **画像エクスポート**（オプション）
   - 個別フレームのPNG出力
   - スプライトシートの生成

## UI設計

### メインレイアウト

```
+---------------------+------------------------+------------------------+
|                     |                        |                        |
| カテゴリツリー      | アセット一覧           | アセット詳細/エディタ  |
| & フィルター        | (グリッド/リスト表示)  |                        |
|                     |                        |                        |
|                     |                        |                        |
|                     |                        |                        |
|                     |                        |                        |
|                     |                        |                        |
|                     |                        |                        |
+---------------------+------------------------+------------------------+
```

### カテゴリナビゲーション（左パネル）

- ツリー構造でカテゴリを表示
- 展開/折りたたみ可能
- 複数選択によるフィルタリング
- 検索ボックス

### アセット一覧（中央パネル）

- グリッド表示（サムネイル）
  - アニメーションのホバープレビュー
  - 選択状態の視覚的表示
- リスト表示（詳細情報）
  - 名前、カテゴリ、更新日などの列
  - ソート機能
- ページネーションまたは無限スクロール
- 新規作成、複製、削除ボタン

### アセット詳細/エディタ（右パネル）

- タブ切り替え
  - 詳細情報タブ
    - 名前
    - カテゴリ
  - エディタタブ
    - 16x16グリッド
    - カラーパレット
    - 基本ツール
  - フレームタブ
    - フレーム一覧（サムネイル）
    - フレーム操作ボタン
  - プレビュータブ
    - 拡大プレビュー
    - アニメーション制御

## 技術スタック

- **ランタイム**: Deno
- **フロントエンド**: React + TypeScript
- **UI**: Ant Design
- **状態管理**: XState
- **ストレージ**: LocalStorage（プロトタイプ段階）
